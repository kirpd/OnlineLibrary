{% extends "base.html" %}
{% block content %}
<h1 class="h1-elem">–í—Å–µ –∫–Ω–∏–≥–∏</h1>
<form action="" method="post" class="form-filter">
    {{ form.hidden_tag() }}
    {{ form.genres.label }}
    {{ form.genres(class="form-control") }}<br>
    {{ form.apply(class="btn btn-primary") }}
</form>
<div class="container main">
    {% for book in books %}
    <div class="card main__item" style="width: 14rem;">
        <img src="data:png;base64,{{ book.image }}" class="card-img-top" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–Ω–∏–≥–∏" height="150">
        <div class="card-body">
            <h5 class="card-title">{{ book.title }}</h5>
            {% set length = book.description | length %}
            <p class="card-text">{% if length > 50 %} {{ book.description[:50] }}... {% else %} {{ book.description
                }}
                {% endif %}</p>
            <p class="card-text">
                <b>–ñ–∞–Ω—Ä:</b> {{ book.str_genre }}
            </p>
            <p class="card-text">
                ‚òÖ {{ book.count_favorites }}
            </p>
            <p class="btn-group btn-group-sm card-text" role="group" aria-label="Basic example">
                <a href="/download_book/{{ book.id }}" class="btn btn-primary">–°–∫–∞—á–∞—Ç—å</a>
                <a href="/read_book/{{ book.id }}" class="btn btn-info">–ß–∏—Ç–∞—Ç—å</a>
                <a href="/info_about_book/{{ book.id }}" class="btn btn-info">üõà</a>
                {% if current_user.is_authenticated and book.id not in books_id %}
                <a href="/{{ url_add }}/{{ book.id }}" class="btn btn-warning">‚òÜ</a>
                {% elif current_user.is_authenticated and book.id in books_id %}
                <a href="/{{ url_delete }}/{{ book.id }}" class="btn btn-warning">‚òÖ</a>
                {% endif %}
            </p>
            {% if current_user.is_authenticated and current_user.is_admin %}
            <p class="btn-group btn-group-sm card-text" role="group" aria-label="Basic example">
                <a href="/edit_book/{{ book.id }}" class="btn btn-secondary">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                <a href="/delete_book/{{ book.id }}" class="btn btn-danger">–£–¥–∞–ª–∏—Ç—å</a>
            </p>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}